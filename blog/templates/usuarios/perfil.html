{% extends 'layouts/general-layout.html' %}
{% load static %}

{% block title %}Mi Perfil ‚Äì {{ usuario.username }}{% endblock title %}

{% block banner %}
<!-- Banner sin cambios seg√∫n tu solicitud -->
<section class="relative w-full h-[320px] md:h-[420px] lg:h-[500px] overflow-hidden">
  <img 
    src="{% static 'img/banner.jpg' %}" 
    alt="Bienvenido a üêæ PetSite"
    fetchpriority="high"
    loading="eager"
    class="w-full h-full object-cover"
  >
  <div class="absolute inset-0 flex items-center justify-center bg-black/40">
    <h1 class="text-white text-4xl md:text-6xl font-extrabold tracking-wide drop-shadow-2xl">
      Bienvenido a tu Perfil
    </h1>
  </div>
</section>
{% endblock banner %}

{% block content %}
<div class="max-w-5xl mx-auto px-4 py-8">

  <!-- Tarjeta principal del perfil -->
  <div class="bg-white rounded-3xl shadow-2xl border border-orange-100 overflow-hidden transition-all duration-300 hover:shadow-3xl">

    <!-- Header con gradiente mejorado -->
    <div class="bg-gradient-to-br from-orange-500 via-amber-500 to-orange-600 p-8 text-center relative">
      <!-- Elemento decorativo -->
      <div class="absolute top-0 left-0 w-32 h-32 bg-white/10 rounded-full -translate-x-16 -translate-y-16"></div>
      <div class="absolute bottom-0 right-0 w-40 h-40 bg-white/5 rounded-full translate-x-20 translate-y-20"></div>
      
      <div class="relative z-10">
        <!-- Avatar con inicial del usuario (ejemplo para Nicol√°s Tomadin) -->
        <div class="relative inline-block mb-4">
          <div class="w-32 h-32 rounded-full bg-gradient-to-br from-white/20 via-white/15 to-white/10 border-4 border-white shadow-2xl flex items-center justify-center mx-auto backdrop-blur-sm">
            <span class="text-white text-4xl font-black drop-shadow-lg">
              {% if usuario.first_name %}
                {{ usuario.first_name|first|upper }}
              {% else %}
                {{ usuario.username|first|upper }}
              {% endif %}
            </span>
          </div>
          <!-- Indicador de estado -->
          <div class="absolute bottom-3 right-3 w-5 h-5 bg-green-500 rounded-full border-2 border-white"></div>
        </div>
        
        <!-- Informaci√≥n del usuario -->
        <div class="space-y-2">
          <h2 class="text-3xl font-black text-white mb-1 tracking-tight">
            {% if usuario.first_name or usuario.last_name %}
              {{ usuario.first_name }} {{ usuario.last_name }}
            {% else %}
              {{ usuario.username }}
            {% endif %}
          </h2>
          <div class="flex items-center justify-center gap-2">
            <span class="text-white/90 text-lg">@{{ usuario.username }}</span>
            {% if usuario.is_staff %}
            <span class="px-2 py-1 bg-white/20 text-white text-xs font-bold rounded-full backdrop-blur-sm">
              Admin
            </span>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <!-- Resto del c√≥digo permanece igual... -->
    <div class="p-8">

      <!-- Estad√≠sticas mejoradas -->
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-10">
        <div class="group text-center p-5 bg-gradient-to-br from-orange-50 to-amber-50 rounded-2xl shadow-md border border-orange-100 hover:border-orange-300 transition-all duration-300 hover:-translate-y-1 cursor-default">
          <div class="text-3xl font-bold text-orange-600 mb-1 group-hover:scale-110 transition-transform">{{ usuario.articulos.count|default:"0" }}</div>
          <div class="text-sm uppercase tracking-wider text-gray-700 font-semibold">Art√≠culos</div>
          <div class="text-xs text-gray-500 mt-1">Publicados</div>
        </div>
        <div class="group text-center p-5 bg-gradient-to-br from-orange-50 to-amber-50 rounded-2xl shadow-md border border-orange-100 hover:border-orange-300 transition-all duration-300 hover:-translate-y-1 cursor-default">
          <div class="text-3xl font-bold text-orange-600 mb-1 group-hover:scale-110 transition-transform">{{ usuario.comentario_set.count|default:"0" }}</div>
          <div class="text-sm uppercase tracking-wider text-gray-700 font-semibold">Comentarios</div>
          <div class="text-xs text-gray-500 mt-1">Realizados</div>
        </div>
        <div class="group text-center p-5 bg-gradient-to-br from-orange-50 to-amber-50 rounded-2xl shadow-md border border-orange-100 hover:border-orange-300 transition-all duration-300 hover:-translate-y-1 cursor-default">
          <div class="text-3xl font-bold text-orange-600 mb-1">{{ usuario.date_joined|timesince|truncatewords:1 }}</div>
          <div class="text-sm uppercase tracking-wider text-gray-700 font-semibold">Miembro</div>
          <div class="text-xs text-gray-500 mt-1">{{ usuario.date_joined|date:"d/m/Y" }}</div>
        </div>
      </div>

      <!-- Informaci√≥n detallada con mejor dise√±o -->
      <div class="grid md:grid-cols-2 gap-6 mb-10">
        <div class="space-y-5">
          <div class="group p-5 bg-gradient-to-br from-white to-orange-50 rounded-2xl shadow-sm border border-orange-100 hover:shadow-md transition-all duration-300">
            <div class="flex items-start gap-4">
              <div class="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-orange-500 to-amber-500 rounded-xl flex items-center justify-center shadow-sm">
                <span class="text-white text-lg">üìß</span>
              </div>
              <div class="flex-1 min-w-0">
                <p class="text-sm font-bold text-orange-700 uppercase tracking-wide mb-1">Email</p>
                <p class="text-gray-800 truncate" title="{{ usuario.email }}">{{ usuario.email }}</p>
              </div>
            </div>
          </div>
          
          {% if usuario.telefono %}
          <div class="group p-5 bg-gradient-to-br from-white to-orange-50 rounded-2xl shadow-sm border border-orange-100 hover:shadow-md transition-all duration-300">
            <div class="flex items-start gap-4">
              <div class="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-orange-500 to-amber-500 rounded-xl flex items-center justify-center shadow-sm">
                <span class="text-white text-lg">üì±</span>
              </div>
              <div>
                <p class="text-sm font-bold text-orange-700 uppercase tracking-wide mb-1">Tel√©fono</p>
                <p class="text-gray-800">{{ usuario.telefono }}</p>
              </div>
            </div>
          </div>
          {% endif %}
        </div>

        <div class="space-y-5">
          <div class="group p-5 bg-gradient-to-br from-white to-orange-50 rounded-2xl shadow-sm border border-orange-100 hover:shadow-md transition-all duration-300">
            <div class="flex items-start gap-4">
              <div class="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-orange-500 to-amber-500 rounded-xl flex items-center justify-center shadow-sm">
                <span class="text-white text-lg">üìÖ</span>
              </div>
              <div>
                <p class="text-sm font-bold text-orange-700 uppercase tracking-wide mb-1">Registrado</p>
                <p class="text-gray-800">{{ usuario.date_joined|date:"d/m/Y" }}</p>
                <p class="text-xs text-gray-500 mt-1">Hace {{ usuario.date_joined|timesince }}</p>
              </div>
            </div>
          </div>
          
          {% if usuario.last_login %}
          <div class="group p-5 bg-gradient-to-br from-white to-orange-50 rounded-2xl shadow-sm border border-orange-100 hover:shadow-md transition-all duration-300">
            <div class="flex items-start gap-4">
              <div class="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-orange-500 to-amber-500 rounded-xl flex items-center justify-center shadow-sm">
                <span class="text-white text-lg">üïê</span>
              </div>
              <div>
                <p class="text-sm font-bold text-orange-700 uppercase tracking-wide mb-1">√öltimo acceso</p>
                <p class="text-gray-800">Hace {{ usuario.last_login|timesince }}</p>
                <p class="text-xs text-gray-500 mt-1">{{ usuario.last_login|date:"H:i" }}</p>
              </div>
            </div>
          </div>
          {% endif %}
        </div>
      </div>

      <!-- Biograf√≠a mejorada -->
      {% if usuario.biografia %}
      <div class="mb-10 group">
        <div class="p-6 bg-gradient-to-br from-white to-orange-50 rounded-2xl shadow-sm border border-orange-100 hover:shadow-md transition-all duration-300">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-10 h-10 bg-gradient-to-br from-orange-500 to-amber-500 rounded-xl flex items-center justify-center shadow-sm">
              <span class="text-white text-lg">‚úçÔ∏è</span>
            </div>
            <h3 class="text-xl font-bold text-orange-700">Sobre m√≠</h3>
          </div>
          <p class="text-gray-700 leading-relaxed text-lg pl-1 border-l-4 border-orange-300 pl-4">{{ usuario.biografia|linebreaks }}</p>
        </div>
      </div>
      {% endif %}

      <!-- Botones de acci√≥n mejorados -->
      <div class="flex flex-wrap justify-center gap-4 mb-2">
        <a href="{% url 'usuarios:editar_perfil' %}" 
           class="group px-7 py-3.5 bg-gradient-to-r from-orange-600 to-amber-600 hover:from-orange-700 hover:to-amber-700 text-white font-bold rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5 flex items-center gap-2">
          <span class="text-lg">‚úèÔ∏è</span>
          Editar Perfil
        </a>
        <a href="{% url 'posts:articulo_crear' %}" 
           class="group px-7 py-3.5 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-bold rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5 flex items-center gap-2">
          <span class="text-lg">‚ú®</span>
          Crear Post
        </a>
        <a href="{% url 'posts:articulo_lista' %}" 
           class="group px-7 py-3.5 bg-gradient-to-r from-gray-800 to-gray-900 hover:from-gray-900 hover:to-black text-white font-bold rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5 flex items-center gap-2">
          <span class="text-lg">üìö</span>
          Ver Posts
        </a>
      </div>

    </div>
  </div>

  <!-- Secci√≥n: Mis √∫ltimos art√≠culos mejorada -->
  {% if usuario.articulos.all %}
  <div class="mt-12 bg-gradient-to-br from-white to-orange-50 rounded-3xl shadow-xl p-8 border border-orange-100">
    <div class="flex items-center justify-between mb-8">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 bg-gradient-to-br from-orange-500 to-amber-500 rounded-xl flex items-center justify-center shadow-sm">
          <span class="text-white text-lg">üìù</span>
        </div>
        <h3 class="text-2xl font-bold text-gray-800">Mis √∫ltimos art√≠culos</h3>
      </div>
      <span class="px-3 py-1 bg-gradient-to-r from-orange-100 to-amber-100 text-orange-700 text-sm font-bold rounded-full">
        {{ usuario.articulos.count }} total
      </span>
    </div>
    
    <div class="grid md:grid-cols-2 gap-6">
      {% for articulo in usuario.articulos.all|slice:":4" %}
        <a href="{% url 'posts:articulo_detalle' articulo.pk %}" 
           class="group block p-5 bg-white rounded-2xl border border-orange-100 hover:border-orange-300 shadow-sm hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
          <div class="flex items-start justify-between mb-3">
            <h4 class="text-lg font-bold text-gray-800 group-hover:text-orange-600 transition-colors truncate pr-2">{{ articulo.titulo }}</h4>
            <span class="flex-shrink-0 text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full">{{ articulo.fecha_publicacion|date:"d/m/Y" }}</span>
          </div>
          <p class="text-gray-600 text-sm mb-4 line-clamp-2">{{ articulo.contenido|truncatewords:25|striptags }}</p>
          <div class="flex items-center justify-between text-sm">
            <div class="flex items-center gap-3">
              <span class="flex items-center gap-1 text-gray-500">
                <span class="text-lg">üëÅÔ∏è</span>
                <span class="font-semibold">{{ articulo.visitas }}</span>
              </span>
              {% if articulo.comentarios.count %}
              <span class="flex items-center gap-1 text-gray-500">
                <span class="text-lg">üí¨</span>
                <span class="font-semibold">{{ articulo.comentarios.count }}</span>
              </span>
              {% endif %}
            </div>
            <span class="text-orange-600 font-semibold group-hover:translate-x-1 transition-transform">Leer ‚Üí</span>
          </div>
        </a>
      {% endfor %}
    </div>
    
    {% if usuario.articulos.count > 4 %}
    <div class="text-center mt-8 pt-6 border-t border-orange-100">
      <a href="{% url 'posts:articulo_lista' %}?autor={{ usuario.username }}" 
         class="inline-flex items-center gap-2 text-orange-600 hover:text-orange-700 font-bold hover:underline transition-colors group">
        Ver todos mis art√≠culos ({{ usuario.articulos.count }})
        <span class="text-xl group-hover:translate-x-1 transition-transform">‚Üí</span>
      </a>
    </div>
    {% endif %}
  </div>
  {% else %}
  <div class="mt-12 bg-gradient-to-br from-white to-orange-50 rounded-3xl shadow-xl p-10 text-center border border-orange-100">
    <div class="w-20 h-20 bg-gradient-to-br from-orange-100 to-amber-100 rounded-full flex items-center justify-center mx-auto mb-6">
      <span class="text-4xl">üìù</span>
    </div>
    <h3 class="text-2xl font-bold text-gray-800 mb-3">¬°Comienza tu aventura!</h3>
    <p class="text-gray-600 mb-8 max-w-md mx-auto">Comparte tus experiencias, consejos y momentos especiales con mascotas. Tu primera publicaci√≥n inspirar√° a otros amantes de los animales.</p>
    <a href="{% url 'posts:articulo_crear' %}" 
       class="inline-flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-orange-600 to-amber-600 hover:from-orange-700 hover:to-amber-700 text-white font-bold rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5">
      <span class="text-xl">‚ú®</span>
      Crear mi primer post
    </a>
  </div>
  {% endif %}

  <!-- Cerrar sesi√≥n con mejor estilo -->
  <div class="mt-10 text-center">
    <a href="{% url 'usuarios:logout' %}" 
       class="inline-flex items-center gap-2 text-gray-600 hover:text-orange-600 font-medium transition-all duration-300 group">
      <span class="text-lg">üö™</span>
      Cerrar sesi√≥n
      <span class="group-hover:translate-x-1 transition-transform">‚Üí</span>
    </a>
    <p class="text-xs text-gray-400 mt-4">Sesi√≥n iniciada el {{ user.last_login|date:"d/m/Y H:i"|default:"Hoy" }}</p>
  </div>

</div>
{% endblock content %}
{% extends 'layouts/general-layout.html' %}
{% load static %}
{% block title %}Eliminar comentario{% endblock title %}

{% block banner %}
<section class="relative w-full h-[300px] md:h-[420px] lg:h-[500px] overflow-hidden">

  <!-- Imagen -->
  <img 
    src="{% static 'img/banner-cargar-articulos.webp' %}" 
    alt="Banner del artículo"
    class="w-full h-full object-cover"
  >

  <!-- Título centrado -->
  <div class="absolute inset-0 flex items-center justify-center bg-black/40">
    <div class="text-center">
      <h1 class="text-white text-4xl md:text-6xl font-extrabold tracking-wide drop-shadow-xl mb-4">
        Eliminar Comentario
      </h1>
      <p class="text-white text-base sm:text-lg md:text-xl font-medium max-w-2xl mx-auto drop-shadow-lg px-2">
        Confirmación requerida para eliminar tu comentario
      </p>
    </div>
  </div>

</section>
{% endblock banner %}

{% block content %}
<div class="max-w-3xl mx-auto px-4 py-12">

  <!-- Breadcrumb -->
  <nav class="mb-8" aria-label="Navegación">
    <ol class="flex items-center space-x-2 text-sm text-gray-600">
      <li>
        <a href="{% url 'posts:articulo_lista' %}" class="hover:text-red-600 transition-colors">
          Posts
        </a>
      </li>
      <li class="text-gray-400">›</li>
      <li>
        <a href="{% url 'posts:articulo_detalle' object.articulo.pk %}" class="hover:text-red-600 transition-colors">
          {{ object.articulo.titulo|truncatechars:30 }}
        </a>
      </li>
      <li class="text-gray-400">›</li>
      <li class="text-red-600 font-semibold">Eliminar comentario</li>
    </ol>
  </nav>

  <!-- Tarjeta principal de confirmación -->
  <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-red-100">
    
    <!-- Encabezado de advertencia -->
    <div class="bg-gradient-to-r from-red-50 to-red-100 px-8 py-6 border-b border-red-200">
      <div class="flex items-center">
        <div class="w-12 h-12 bg-white border-2 border-red-200 rounded-full flex items-center justify-center mr-4">
          <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
          </svg>
        </div>
        <div>
          <h2 class="text-2xl font-bold text-red-900">Confirmar eliminación</h2>
          <p class="text-red-700 mt-1">Esta acción no se puede deshacer</p>
        </div>
      </div>
    </div>

    <!-- Contenido de la confirmación -->
    <div class="p-8">
      <!-- Alerta de peligro -->
      <div class="mb-8 p-6 bg-red-50 border border-red-200 rounded-xl shadow-sm">
        <div class="flex items-start">
          <svg class="w-6 h-6 text-red-600 mt-0.5 mr-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
          </svg>
          <div class="flex-1">
            <h3 class="text-lg font-bold text-red-800 mb-2">¡Advertencia importante!</h3>
            <ul class="space-y-2 text-red-700">
              <li class="flex items-start">
                <svg class="w-5 h-5 text-red-600 mr-2 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span>El comentario será eliminado permanentemente</span>
              </li>
              <li class="flex items-start">
                <svg class="w-5 h-5 text-red-600 mr-2 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span>Esta acción no se puede deshacer ni recuperar</span>
              </li>
              <li class="flex items-start">
                <svg class="w-5 h-5 text-red-600 mr-2 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span>Otros usuarios ya no podrán ver este comentario</span>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Vista previa del comentario a eliminar -->
      <div class="mb-8 p-6 bg-gray-50 border border-gray-200 rounded-xl">
        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
          <svg class="w-5 h-5 text-gray-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
          </svg>
          Comentario que será eliminado
        </h3>
        
        <div class="bg-white rounded-lg p-4 border border-gray-300">
          <!-- Información del autor -->
          <div class="flex items-center mb-3 pb-3 border-b border-gray-100">
            <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mr-3">
              <svg class="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
              </svg>
            </div>
            <div>
              <p class="font-semibold text-gray-800">{{ object.autor.username }}</p>
              <p class="text-xs text-gray-500">Publicado el {{ object.fecha_creacion|date:"d/m/Y H:i" }}</p>
            </div>
          </div>
          
          <!-- Contenido del comentario -->
          <div class="text-gray-700 leading-relaxed">
            {{ object.contenido|linebreaks }}
          </div>
        </div>
      </div>

      <!-- Artículo relacionado -->
      <div class="mb-8 p-6 bg-blue-50 border border-blue-200 rounded-xl">
        <h3 class="text-lg font-semibold text-blue-800 mb-3 flex items-center">
          <svg class="w-5 h-5 text-blue-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path>
          </svg>
          Comentario publicado en
        </h3>
        
        <div class="flex items-start">
          {% if object.articulo.imagenes.all %}
            <img src="{{ object.articulo.imagenes.all.0.imagen.url }}" 
                 alt="{{ object.articulo.titulo }}"
                 class="w-16 h-16 object-cover rounded-lg mr-4 flex-shrink-0 shadow-sm">
          {% endif %}
          <div>
            <h4 class="font-bold text-gray-900">{{ object.articulo.titulo }}</h4>
            <p class="text-gray-600 text-sm mt-1">
              {{ object.articulo.descripcion|truncatechars:100 }}
            </p>
            <div class="flex items-center mt-2 text-xs text-gray-500">
              <span class="flex items-center mr-3">
                <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                {{ object.articulo.fecha_publicacion|date:"d/m/Y" }}
              </span>
              <span class="flex items-center">
                <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                </svg>
                {{ object.articulo.visitas }} vistas
              </span>
            </div>
          </div>
        </div>
      </div>

      <!-- Formulario de confirmación -->
      <form method="POST" id="deleteForm" class="space-y-6">
        {% csrf_token %}
        
        <!-- Checkbox de confirmación -->
        <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-6">
          <div class="flex items-start mb-4">
            <input type="checkbox" id="confirmDelete" name="confirmDelete" 
                   class="mt-1 mr-3 h-5 w-5 text-red-600 border-gray-300 rounded focus:ring-red-500">
            <label for="confirmDelete" class="text-yellow-800 font-medium cursor-pointer select-none">
              <span class="block text-lg font-bold mb-1">Confirmo que entiendo las consecuencias</span>
              <span class="text-yellow-700">
                He leído la advertencia y comprendo que esta acción eliminará permanentemente mi comentario. 
                No podré recuperarlo una vez eliminado.
              </span>
            </label>
          </div>
          
          <div class="flex items-center text-sm text-yellow-700 bg-yellow-100 p-3 rounded-lg">
            <svg class="w-5 h-5 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            Marca esta casilla para habilitar el botón de eliminación
          </div>
        </div>

        <!-- Botones de acción -->
        <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t border-gray-100">
          <button 
            type="submit" 
            id="deleteButton"
            class="inline-flex items-center justify-center px-6 py-3 bg-gray-300 text-gray-500 font-bold rounded-lg shadow transition-all duration-200 flex-1 cursor-not-allowed"
            disabled
          >
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
            </svg>
            Confirmar eliminación
          </button>

          <a href="{% url 'posts:articulo_detalle' object.articulo.pk %}" 
             class="inline-flex items-center justify-center px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold rounded-lg shadow hover:shadow-lg transition-all duration-200 flex-1"
          >
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
            Cancelar y volver
          </a>
        </div>
        
        <!-- Enlace para editar en lugar de eliminar -->
        <div class="text-center pt-4">
          <p class="text-gray-600 text-sm mb-2">
            ¿Prefieres editar el comentario en lugar de eliminarlo?
          </p>
          <a href="{% url 'comentarios:editar_comentario' object.pk %}" 
             class="inline-flex items-center text-orange-600 hover:text-orange-800 font-medium"
          >
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
            </svg>
            Editar comentario en su lugar
          </a>
        </div>
      </form>
    </div>
  </div>

  <!-- Consideraciones adicionales -->
  <div class="mt-8 bg-white rounded-xl shadow-lg p-6">
    <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center">
      <svg class="w-5 h-5 text-gray-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      ¿Por qué eliminar en lugar de editar?
    </h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div class="bg-gray-50 p-4 rounded-lg">
        <h4 class="font-semibold text-gray-800 mb-2 flex items-center">
          <svg class="w-4 h-4 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          Considera editar si:
        </h4>
        <ul class="text-gray-600 text-sm space-y-1">
          <li class="flex items-start">
            <span class="mr-2">•</span>
            <span>Solo necesitas corregir errores</span>
          </li>
          <li class="flex items-start">
            <span class="mr-2">•</span>
            <span>Quieres mejorar la redacción</span>
          </li>
          <li class="flex items-start">
            <span class="mr-2">•</span>
            <span>El contenido es útil pero necesita ajustes</span>
          </li>
          <li class="flex items-start">
            <span class="mr-2">•</span>
            <span>Hay información desactualizada</span>
          </li>
        </ul>
      </div>
      <div class="bg-gray-50 p-4 rounded-lg">
        <h4 class="font-semibold text-gray-800 mb-2 flex items-center">
          <svg class="w-4 h-4 text-red-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
          Considera eliminar si:
        </h4>
        <ul class="text-gray-600 text-sm space-y-1">
          <li class="flex items-start">
            <span class="mr-2">•</span>
            <span>El comentario es ofensivo</span>
          </li>
          <li class="flex items-start">
            <span class="mr-2">•</span>
            <span>Contiene información incorrecta</span>
          </li>
          <li class="flex items-start">
            <span class="mr-2">•</span>
            <span>Ya no es relevante</span>
          </li>
          <li class="flex items-start">
            <span class="mr-2">•</span>
            <span>Prefieres no participar más</span>
          </li>
        </ul>
      </div>
    </div>
  </div>

</div>

<style>
  /* Scrollbar personalizado */
::-webkit-scrollbar {
  width: 10px;
}

::-webkit-scrollbar-track {
  background: #fed7aa;
  border-radius: 5px;
}

::-webkit-scrollbar-thumb {
  background: linear-gradient(to bottom, #f97316, #f59e0b);
  border-radius: 5px;
  border: 2px solid #fed7aa;
}

::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(to bottom, #ea580c, #d97706);
}
</style>

<!-- Script para controlar el botón de eliminación -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const confirmCheckbox = document.getElementById('confirmDelete');
  const deleteButton = document.getElementById('deleteButton');
  const deleteForm = document.getElementById('deleteForm');
  
  if (confirmCheckbox && deleteButton) {
    // Inicialmente deshabilitado
    deleteButton.disabled = true;
    deleteButton.classList.remove('bg-red-600', 'hover:from-red-700', 'hover:to-red-800');
    deleteButton.classList.add('bg-gray-300', 'text-gray-500', 'cursor-not-allowed');
    
    // Habilitar/deshabilitar botón según checkbox
    confirmCheckbox.addEventListener('change', function() {
      if (this.checked) {
        deleteButton.disabled = false;
        deleteButton.classList.remove('bg-gray-300', 'text-gray-500', 'cursor-not-allowed');
        deleteButton.classList.add('bg-gradient-to-r', 'from-red-600', 'to-red-700', 'hover:from-red-700', 'hover:to-red-800', 'text-white', 'cursor-pointer');
        deleteButton.innerHTML = `
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
          </svg>
          Sí, eliminar permanentemente
        `;
      } else {
        deleteButton.disabled = true;
        deleteButton.classList.remove('bg-gradient-to-r', 'from-red-600', 'to-red-700', 'hover:from-red-700', 'hover:to-red-800', 'text-white', 'cursor-pointer');
        deleteButton.classList.add('bg-gray-300', 'text-gray-500', 'cursor-not-allowed');
        deleteButton.innerHTML = `
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
          </svg>
          Confirmar eliminación
        `;
      }
    });
    
    // Prevenir envío accidental con Enter
    deleteForm.addEventListener('keydown', function(e) {
      if (e.key === 'Enter' && !confirmCheckbox.checked) {
        e.preventDefault();
        // Animación para llamar la atención al checkbox
        confirmCheckbox.focus();
        confirmCheckbox.parentElement.classList.add('animate-pulse');
        setTimeout(() => {
          confirmCheckbox.parentElement.classList.remove('animate-pulse');
        }, 1000);
      }
    });
    
    // Efecto hover en el botón cuando está habilitado
    deleteButton.addEventListener('mouseenter', function() {
      if (!this.disabled) {
        this.classList.add('shadow-xl', 'scale-105');
      }
    });
    
    deleteButton.addEventListener('mouseleave', function() {
      this.classList.remove('shadow-xl', 'scale-105');
    });
  }
});

// Estilos para animación
const style = document.createElement('style');
style.textContent = `
  .animate-pulse {
    animation: pulse 1s ease-in-out;
  }
  
  @keyframes pulse {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.7;
    }
  }
  
  input[type="checkbox"]:checked {
    background-color: #dc2626;
  }
`;
document.head.appendChild(style);
</script>

{% endblock content %}